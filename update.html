<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta id="viewport" content="width=device-width, initial-scale=1.0">
    <title>Update</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

</head>
<body>
    <div id="loader" class="loading d-none">
    </div>
    
    <button><a href="create.html">create</a></button>
    <div class="container">
        <label>Product ID</label>
        <input id="ProductID" type="text">
        <label>Product Name</label>
        <input id="ProductName" type="text">
        <label>Product Code</label>
        <input id="ProductCode" type="text">
        <label>Unit Price</label>
        <input id="UnitPrice" type="text">
        <label>Product Qty</label>
        <input id="ProductQty" type="text">
        <label>Product Total</label>
        <input id="TotalPrice" type="text">
        <div class="row">
            <button onclick="updateItem()">Update</button>
        </div>
    </div>
    <script src="js/axios.min.js"></script>

    <script>
        fillExistingData()
       async function fillExistingData(){
        const urlParams = new URLSearchParams(window.location.search);
        const id = urlParams.get('id');
        document.getElementById('loader').classList.remove('d-none')
        let res = await axios.get(`https://crud.teamrabbil.com/api/v1/ReadProductByID/${id}`);
        document.getElementById('loader').classList.add('d-none')
        if(res.status === 200){
            let items = res.data['data'][0]
            console.log(items);
            document.getElementById('ProductID').value=items['_id'];
            document.getElementById('ProductName').value=items['ProductName'];
            document.getElementById('ProductCode').value=items['ProductCode'];
            document.getElementById('UnitPrice').value=items['UnitPrice'];
            document.getElementById('ProductQty').value=items['Qty'];
            document.getElementById('TotalPrice').value=items['TotalPrice'];
        }else{
            console.log('error');
        }
        
        }

       async function updateItem(){
          let ProductID     =   document.getElementById('ProductID').value;
          let ProductName   =   document.getElementById('ProductName').value;
          let ProductCode   =   document.getElementById('ProductCode').value;
          let UnitPrice     =   document.getElementById('UnitPrice').value;
          let ProductQty    =   document.getElementById('ProductQty').value;
          let TotalPrice    =   document.getElementById('TotalPrice').value;

          createObj = {
                "ProductName" : ProductName,
                "ProductCode" :  ProductCode,
                "UnitPrice"   :  UnitPrice,
                "ProductQty"  :  ProductQty,
                "TotalPrice"  :  TotalPrice,
          }
          let res = await axios.post(`https://crud.teamrabbil.com/api/v1/UpdateProduct/${ProductID}`,createObj);
        
          if(res.status === 200){
            window.location="index.html"
          }else{
            console.log('error');
          }
       }

    </script>

    
</body>
</html>